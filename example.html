<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>canvas test by fabric</title>
    <style>
    </style>
    <link rel="stylesheet" href="css/mapPlugin.css" type="text/css"/>
    <script src="js/fabric.js"></script>
    <script src="js/mapPlugin.js"></script>

</head>
<body>
<div id="canvas" style="width:960px;height:720px;z-index:0;position: relative;left:50px;top:50px;">
</div>

<script>
    var map = mapPlugin("canvas", {
        imgSrc: 'img/back.png',
        imgWidth: 1055, imgHeight: 788,
        fixedPositions: [{
            type: 'circle', trueX: 0, trueY: 0, x: 0, y: 0, options: {
                r: 0, color: 'red',
                clickAction: 'console.log',
            }
        }, {
            type: 'img',
            trueX: 960,
            trueY: 720,
            x: 960,
            y: 720,
            options: {
                height: 1,
                width: 1,
                src: 'img/camera.png',
                clickAction: 'console.log',
            }
        }]
    }, "map");
    var move = function () {
        var maxRoleY = 800;
        var minRoleY = 300;
        var minTruckY = 100;
        var maxTruckY = 900;
        map.refresh([{
            type: 'img',
            x: minRoleY + (maxRoleY - minRoleY) * Math.random(), y: 520,
            options: {
                height: 20,
                width: 20,
                src: 'img/role.png',
                selectable: false
            }
        }, {
            type: 'img',
            x: minRoleY + (maxRoleY - minRoleY) * Math.random(), y: 550,
            options: {
                height: 20,
                width: 20,
                src: 'img/role.png',
                selectable: false
            }
        }, {
            type: 'img',
            x: minTruckY + (maxTruckY - minTruckY) * Math.random(), y: 541,
            options: {
                height: 20,
                width: 20,
                src: 'img/truck.png',
                selectable: false
            }
        }])
    }
    move();
    map.addFixedPosition([{
        type: 'img',
        trueX: 417, trueY: 500,
        options: {
            height: 20,
            width: 20,
            src: 'img/speaker.png',
            selectable: false
        }
    }, {
        type: 'circle', trueX: 100, trueY: 200, options: {
            r: 8, color: null,
            stroke: 'black', strokeWidth: 2,
            clickAction: 'console.log'
        }
    }, {
        type: 'img',
        trueX: 362, trueY: 370,
        options: {
            height: 20,
            width: 20,
            src: 'img/camera.png',
            selectable: false
        }
    }, {
        type: 'img',
        trueX: 455, trueY: 560,
        options: {
            height: 20,
            width: 20,
            src: 'img/role.png',
            selectable: true
        }
    }])
    map.addAlertPosition({trueX: 200, trueY: 300, type: 'square', width: 50, height: 40, level: 2, positionType: 'F'});
    map.addAlertPosition({trueX: 400, trueY: 200, type: 'circle', r: 20, level: 1, positionType: 'F'});
    map.addAlertPosition({trueX: 200, trueY: 300, type: 'circle', r: 10, level: 0, positionType: 'F'});
    setInterval("move()", 2000);
</script>
</body>
</html></html>